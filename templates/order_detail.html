{% extends 'base.html' %}

{% block title %}Order Details - Anupam SweatsShop{% endblock %}

{% block content %}
<div class="order-detail-container">
    <div class="breadcrumb">
        <a href="/">Home</a> / <a href="/orders">Orders</a> / <span>{{ order.order_number }}</span>
    </div>

    <h1>Order Details</h1>

    <!-- Order Header -->
    <div class="order-header-card">
        <div class="order-header-info">
            <h2>{{ order.order_number }}</h2>
            <p class="order-date">{{ order.created_at.strftime('%B %d, %Y at %I:%M %p') }}</p>
        </div>
        <div class="order-status-box">
            <span class="status-badge status-{{ order.status.lower() }}">
                {{ order.status }}
            </span>
        </div>
    </div>

    <!-- Order Details Grid -->
    <div class="order-details-grid">
        <!-- Shipping Information -->
        <div class="detail-card">
            <h3>Shipping Address</h3>
            <p>{{ order.customer_name }}</p>
            <p>{{ order.shipping_address }}</p>
            <p>{{ order.shipping_city }}, {{ order.shipping_state }} {{ order.shipping_zip }}</p>
            <p><strong>Phone:</strong> {{ order.customer_phone or 'N/A' }}</p>
        </div>

        <!-- Customer Information -->
        <div class="detail-card">
            <h3>Customer Information</h3>
            <p><strong>Name:</strong> {{ order.customer_name }}</p>
            <p><strong>Email:</strong> {{ order.customer_email }}</p>
            <p><strong>Phone:</strong> {{ order.customer_phone or 'N/A' }}</p>
        </div>

        <!-- Order Information -->
        <div class="detail-card">
            <h3>Order Information</h3>
            <p><strong>Order Number:</strong> {{ order.order_number }}</p>
            <p><strong>Payment Method:</strong> {{ order.payment_method }}</p>
            <p><strong>Order Date:</strong> {{ order.created_at.strftime('%Y-%m-%d') }}</p>
        </div>
    </div>

    <!-- Order Items -->
    <div class="order-items-card">
        <h2>Items Ordered</h2>
        <table class="order-items-table">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Size</th>
                    <th>Color</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order.items %}
                <tr>
                    <td>{{ item.product.name }}</td>
                    <td>{{ item.size }}</td>
                    <td>{{ item.color }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>${{ "%.2f"|format(item.price_at_purchase) }}</td>
                    <td>${{ "%.2f"|format(item.quantity * item.price_at_purchase) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Order Summary -->
    <div class="order-summary-card">
        <div class="summary-row">
            <span>Subtotal:</span>
            <span>${{ "%.2f"|format(order.total_amount * 0.926) }}</span>
        </div>
        <div class="summary-row">
            <span>Tax:</span>
            <span>${{ "%.2f"|format(order.total_amount * 0.074) }}</span>
        </div>
        <div class="summary-row total">
            <span>Total:</span>
            <span>${{ "%.2f"|format(order.total_amount) }}</span>
        </div>
    </div>

    <!-- Order Notes -->
    {% if order.notes %}
    <div class="notes-card">
        <h3>Order Notes</h3>
        <p>{{ order.notes }}</p>
    </div>
    {% endif %}

    <!-- Actions -->
    <div class="order-actions">
        <button class="btn btn-primary" onclick="printOrder()">üñ®Ô∏è Print Order</button>
        <a href="/orders" class="btn btn-secondary">Back to Orders</a>
    </div>
</div>

<style>
    .order-detail-container {
        background: white;
        padding: 2rem;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        max-width: 900px;
        margin: 2rem auto;
    }

    .order-header-card {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 2rem;
        background: linear-gradient(135deg, #f9f9f9, #f0f0f0);
        border-radius: 8px;
        margin-bottom: 2rem;
    }

    .order-header-info h2 {
        margin: 0;
        color: var(--dark-color);
    }

    .order-date {
        color: #999;
        margin: 0.5rem 0 0 0;
    }

    .order-details-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .detail-card {
        background: #f9f9f9;
        padding: 1.5rem;
        border-radius: 8px;
        border-left: 4px solid var(--primary-color);
    }

    .detail-card h3 {
        margin-bottom: 1rem;
        color: var(--dark-color);
    }

    .detail-card p {
        margin: 0.5rem 0;
        color: #666;
    }

    .order-items-card,
    .order-summary-card,
    .notes-card {
        background: #f9f9f9;
        padding: 1.5rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }

    .order-items-table {
        width: 100%;
        border-collapse: collapse;
    }

    .order-items-table th {
        background: var(--primary-color);
        color: white;
        padding: 1rem;
        text-align: left;
    }

    .order-items-table td {
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
    }

    .summary-row {
        display: flex;
        justify-content: space-between;
        padding: 0.75rem 0;
    }

    .summary-row.total {
        font-weight: bold;
        font-size: 1.2rem;
        color: var(--primary-color);
        padding: 1rem 0;
        border-top: 2px solid var(--border-color);
    }

    .order-actions {
        display: flex;
        gap: 1rem;
    }

    @media (max-width: 768px) {
        .order-header-card {
            flex-direction: column;
            text-align: center;
        }

        .order-details-grid {
            grid-template-columns: 1fr;
        }

        .order-actions {
            flex-direction: column;
        }

        .btn {
            width: 100%;
        }
    }
</style>

<script>
    function printOrder() {
        window.print();
    }
</script>
{% endblock %}